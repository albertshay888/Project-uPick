<!DOCTYPE html>
<html>
  <head>
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no">
    <meta charset="utf-8">
    <title>Place Search Pagination</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">    

    <link rel="stylesheet" href="style.css">

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script src="https://www.gstatic.com/firebasejs/5.5.9/firebase.js"></script>

    <script>
     
      
    
      var map, infoWindow;
      
      var userLat;
      var userLng;
      var userLoc;
      var service;
      var pos;
 
      function initMap() {
        map = new google.maps.Map(document.getElementById('map'), {
          center: new google.maps.LatLng(userLat, userLng),
          zoom: 15
        });
        infoWindow = new google.maps.InfoWindow;
        // userLoc = new google.maps.LatLng(userLat, userLng);
        console.log(userLoc);
    //   function initMap() {
    //     // Create the map.
    //     var currentLocation = {lat: -33.866, lng: 151.196};
    //     map = new google.maps.Map(document.getElementById('map'), {
    //       center: currentLocation,
    //       zoom: 17
    //     });
//GET USER LOCATION
        if (navigator.geolocation) {
        console.log(navigator.geolocation)
          navigator.geolocation.getCurrentPosition(function(position) {
              console.log(position)
            pos = {
              lat: position.coords.latitude,
              lng: position.coords.longitude
            };
             userLat = pos.lat;
             userLng = pos.lng;
            console.log(userLat);
            console.log(userLng);
         
            //  userLoc = {lat: userLat, lng: userLng };
            console.log(pos);
            //SHOWS USER POSITION
            infoWindow.setPosition(pos);
            infoWindow.setContent('You are here');
            infoWindow.open(map);
            map.setCenter(pos);
        infowindow = new google.maps.InfoWindow();
            service = new google.maps.places.PlacesService(map);
            service.nearbySearch({
                location: pos,
                radius: 10000,
                type: ['restaurant'], 
                keyword: winner,
            }, callback);
            function callback(results, status) {
                if (status === google.maps.places.PlacesServiceStatus.OK) {
                for (var i = 0; i < results.length; i++) {
                    createMarker(results[i]);
                    // console.log(results);
                    
                  }
                  // finalPicks.push(results);
                }
                // console.log(finalPicks);
            }
         function createMarker(place) {
        var placeLoc = place.geometry.location;
        var marker = new google.maps.Marker({
          map: map,
          position: place.geometry.location
        });
        google.maps.event.addListener(marker, 'click', function() {
        
      // var selectBtn = $('<button>');
      //     selectBtn.addClass("selectButton");
      //     selectBtn.text("Select This Restaurant");
          
  
          infowindow.setContent(place.name + "<br>" + place.vicinity + "<br>" + place.rating + "<br>" + "Price level: " + place.price_level + "<br>" + place.opening_hours.open_now );
          infowindow.open(map, this);
              
              google.maps.event.addListener(marker, 'click', function() {
                 confirm("select this restaurant");
                 if (confirm == true) {
                   //MICKEY
                   //WRITE
                   //ROUTING
                   //FUNCTION
                   //HERE
                 }
            
               });
        }); 
      
        
///////find places
        
     
///////////////
            
        //   function() {
        //     handleLocationError(true, infoWindow, map.getCenter());
        //   };
        } 
      });
}
}
//////////// showing results to user
// $("#places").append(finalPicks);
          </script>
  </head>
  
  <body>

      <body>

          <div class="container">
              <div class="row">
                  <div class="cuisine-display button">
                  </div>
              </div>
          
              <!-- Display final result-->
              <div class="result"></div>
          </div>
          <br>
          <p class="correct-answer">The pick:
              <div id="correct-answer-id"></div>
              <br>
          
              <hr>
              <div>
                  <h3 class="">Trending:
                      <strong>
                          <span id="connected-viewers"></span>
                      </strong> currently on uPick.</h3>
              </div>

    <div id="map"></div>
    <div id="right-panel">
      <h2>Results</h2>
      <ul id="places"></ul>
      <button id="more">More results</button>
    </div>

    <!-- <div class="list-results"></div> -->


    <script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBW2P5znpC7asNyzcITnoDRVOutOYjmPzU&callback=initMap&libraries=places"></script>
    <!-- <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBW2P5znpC7asNyzcITnoDRVOutOYjmPzU&libraries=places&callback=initMap" async defer></script> -->
  </body>




  
</html>






<!-- 
        // else {
        //   // Browser doesn't support Geolocation
        //   handleLocationError(false, infoWindow, map.getCenter());
        // }
      
//places results
// function initMap() {
//         var pyrmont = {lat: -33.867, lng: 151.195};
//         map = new google.maps.Map(document.getElementById('map'), {
//           center: pyrmont,
//           zoom: 15
//         });
//         infowindow = new google.maps.InfoWindow();
//         var service = new google.maps.places.PlacesService(map);
//         service.nearbySearch({
//           location: pyrmont,
//           radius: 500,
//           type: ['store']
//         }, callback);
//       }
//       function callback(results, status) {
//         if (status === google.maps.places.PlacesServiceStatus.OK) {
//           for (var i = 0; i < results.length; i++) {
//             createMarker(results[i]);
            
//           }
//         }
//       }
//       function createMarker(place) {
//         var placeLoc = place.geometry.location;
//         var marker = new google.maps.Marker({
//           map: map,
//           position: place.geometry.location
//         });
//         google.maps.event.addListener(marker, 'click', function() {
//           infowindow.setContent(place.name);
//           infowindow.open(map, this);
//         });
//       }
    
    
    
    
    
    
    
    //  infowindow = new google.maps.InfoWindow();
    //     service = new google.maps.places.PlacesService(map);
    //     service.nearbySearch({
    //       location: userLoc,
    //       radius: 300,
    //       type: ['restaurant'],
    //     }, callback);
    //   }
    //   function callback(results, status) {
    //     if (status === google.maps.places.PlacesServiceStatus.OK) {
    //       for (var i = 0; i < results.length; i++) {
    //         createMarker(results[i]);
    //       }
    //     }
    //   }
    //   function createMarker(place) {
    //     var placeLoc = place.geometry.location;
    //     var marker = new google.maps.Marker({
    //       map: map,
    //       position: place.geometry.location
    //     });
    //     google.maps.event.addListener(marker, 'click', function() {
    //       infowindow.setContent(place.name);
    //       infowindow.open(map, this);
    //     });
    //   }
      
    //   function handleLocationError(browserHasGeolocation, infoWindow, pos) {
    //     infoWindow.setPosition(pos);
    //     infoWindow.setContent(browserHasGeolocation ?
    //                           'Error: The Geolocation service failed.' :
    //                           'Error: Your browser doesn\'t support geolocation.');
    //     infoWindow.open(map);
    //   }
 
    // //     // Create the places service.
        //  service = new google.maps.places.PlacesService(map);
            // service.nearbySearch(request, callback);
    //     var getNextPage = null;
    //     var moreButton = document.getElementById('more');
    //     moreButton.onclick = function() {
    //       moreButton.disabled = true;
    //       if (getNextPage) getNextPage();
    //     };
            // service.nearbySearch({
            //     location : userLoc,
            //     radius : 300,
            //     // {lat: userLat, lng: userLng}
            //     type : 'restaurant',
            //     keyword: "italian",
            // }, callback);
            
    // //     // Perform a nearby search.
//     function callback(results, status) {
//             if (status === google.maps.places.PlacesServiceStatus.OK) {
//                 for (var i = 0; i < results.length; i++) {
//                     createMarker(results[i]);
//                     console.log(results);
//                 }
//             }
//         }
// function createMarker(results) {
//             var placeLoc = place.geometry.location;
//             var marker = new google.maps.Marker({
//                 map : map,
//                 position : place.geometry.location
//             });
//             google.maps.event.addListener(marker, 'click', function() {
//                 infowindow.setContent(place.name);
//                 infowindow.open(map, this);
//             });
//         }
        
            // function(results, status, pagination) {
            //   if (status !== 'OK') return;
    //           createMarkers(results);
    //           moreButton.disabled = !pagination.hasNextPage;
    //           getNextPage = pagination.hasNextPage && function() {
    //             pagination.nextPage();
    //           };
    //         });
      
    //   function createMarkers(places) {
    //     var bounds = new google.maps.LatLngBounds();
    //     var placesList = document.getElementById('places');
    //     for (var i = 0, place; place = places[i]; i++) {
    //       var image = {
    //         url: place.icon,
    //         size: new google.maps.Size(71, 71),
    //         origin: new google.maps.Point(0, 0),
    //         anchor: new google.maps.Point(17, 34),
    //         scaledSize: new google.maps.Size(25, 25)
    //       };
    //       var marker = new google.maps.Marker({
    //         map: map,
    //         icon: image,
    //         title: place.name,
    //         position: place.geometry.location
    //       });
        //   var li = document.createElement('li');
        //   li.textContent = place.name;
        //   placesList.appendChild(li);
        //   console.log(places);
    //       bounds.extend(place.geometry.location);
    //     }
    //     map.fitBounds(bounds);
    //   }
// }; -->

